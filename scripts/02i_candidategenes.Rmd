---
title: "candidate genes"
output: md_document
---

```{r setup, include=FALSE}
library(tidyverse)
library(stringr) # for sentence to upper case conversion
library(kableExtra) # for pretty tables

knitr::opts_chunk$set(echo = TRUE)
```

I want to examine the extent to which know learning and memory genes are found to be differentially expressed in this analysis. Do ask that question, I need to do a little data wrangling first. To address this questions, I will use a list of 237 candidate genes from Sanes and Lichtman 1999.

```{r sanes}
# prep sanes data
sanesLichtman <- read.csv("../data/02i_sanesLichtman.csv", header = T, stringsAsFactors = F)
sanesLichtman <- as.list(sanesLichtman$genes)
length(sanesLichtman)

# prep region-specifi gene expression data
wrangledata <- function(filename, mycomparison){
  mydata <- read.csv(filename, header = T)
  mydata$gene <- str_to_upper(mydata$gene)
  mydata$comparison <- mycomparison
  return(mydata)
}

DG_Cons_YCons <- wrangledata("../data/DG-consistent-yokedconsistent.csv", "DG_Cons_YCons")
CA1_YConf_YCons <- wrangledata("../data/CA1-yokedconflict-yokedconsistent.csv", "CA1_YConf_YCons")
CA1_Cons_YCons <- wrangledata("../data/CA1-consistent-yokedconsistent.csv", "CA1_Cons_YCons")
CA1DG <- wrangledata("../data/DGvCA1.csv", "CA1_DG")
CA1CA3 <- wrangledata("../data/CA3vCA1.csv", "CA1_CA3")
CA3DG <- wrangledata("../data/DGvCA3.csv", "CA3_DG")

# print sanesLichtman DEGS
candidate_summary <- function(mydf){
    df <- mydf %>%
      dplyr::filter(gene %in% sanesLichtman) %>%
      dplyr::arrange(gene) %>%
      dplyr::filter(direction != "neither")
    print(df)
}
```

Which genes from the Sanes and Licthemn 1999 essay are differntially expressed in **the DG and CA1 response to active place avoidance training?**

```{r APAtraining}
candidate_summary(DG_Cons_YCons)
candidate_summary(CA1_Cons_YCons)
```

Which genes from the Sanes and Licthemn 1999 essay are differntially expressed in **the CA1 response to increased punishment?**

```{r stress}
candidate_summary(CA1_YConf_YCons)
```

Which of the genes are differentially expressed **between subfields, ignoring treatment effects?**

```{r regionalspecificity}
candidate_summary(CA1DG)
candidate_summary(CA1CA3)
candidate_summary(CA3DG)
```